# 提案删除功能

## 功能概述
为历史记录页面添加了提案删除功能，用户可以在特定条件下删除自己创建的提案。

## 新增文件

### API 路由
- `app/api/proposals/[id]/route.ts` - 处理单个提案的删除操作
  - DELETE: 删除提案（限制条件下）

### Hooks
- `hooks/useProposalManagement.ts` - 提案删除相关的钩子函数
  - deleteProposal: 删除提案

### 模态组件
- `components/modals/ConfirmDeleteModal.tsx` - 删除确认模态框

## 功能详情

### 删除提案
- **条件**: 
  - `pending` 状态的提案
  - 或者没有任何投票的提案（`votesFor + votesAgainst === 0`）
- **权限**: 只有提案作者可以删除
- **UI**: 点击"删除"按钮，显示确认对话框

## UI/UX 改进

### 历史记录页面
- 在每个提案卡片底部添加了删除按钮
- 根据提案状态和投票情况动态显示删除按钮
- 添加了操作提示信息："💡 只能删除待审核或无投票的提案"

### 按钮样式
- **删除**: 红色边框和文字，hover时有缩放动画

### 模态框设计
- 统一的像素化风格
- 响应式设计，支持移动端
- 确认对话框防止误操作
- 加载状态显示

## 安全特性

### 权限验证
- 所有操作都验证钱包地址
- 后端双重验证提案作者身份
- 状态检查确保操作的合法性

### 数据完整性
- 状态一致性检查
- 防止删除有投票的活跃提案

## 用户体验

### 状态反馈
- 成功/失败的 toast 通知
- 实时状态更新
- 加载状态指示器

### 响应式交互
- 按钮 hover 和点击动画
- 平滑的模态框动画
- 直观的图标和颜色编码

## 技术实现

### 状态管理
- 使用 React hooks 管理组件状态
- 实时数据同步和刷新
- 错误状态处理

### API 设计
- RESTful API 设计
- 统一的错误响应格式
- 适当的 HTTP 状态码

### 数据库操作
- MongoDB 删除操作
- 索引优化查询性能
- 数据验证和约束

## 使用说明

1. **连接钱包**: 访问历史记录需要先连接钱包
2. **查看提案**: 历史记录页面显示用户的所有提案
3. **删除操作**: 
   - 待审核提案可以删除
   - 没有投票的提案可以删除
4. **确认操作**: 删除操作需要二次确认
5. **状态更新**: 操作完成后页面自动刷新显示最新状态

## 注意事项

- 只能删除自己创建的提案
- 删除操作是不可逆的
- 已有投票的提案不能删除
- 只有特定状态的提案可以删除 